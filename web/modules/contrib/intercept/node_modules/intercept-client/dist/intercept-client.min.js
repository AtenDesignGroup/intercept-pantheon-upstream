!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("redis"),require("crypto")):"function"==typeof define&&define.amd?define(["redis","crypto"],t):e.interceptClient=t(e.redis,e.crypto)}(this,function(e,t){"use strict";function n(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),i=0;t>i;i++)r[i]=arguments[i];var o={type:e};return n.forEach(function(e,t){o[n[t]]=r[t]}),o}}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var r="intercept/ADD",i="intercept/CLEAR_ERRORS",o="intercept/EDIT",a="intercept/FAILURE",u="intercept/MARK_DIRTY",s="intercept/PURGE",c="intercept/RECEIVE",l="intercept/RECEIVE_TRANSLATION",p="intercept/REQUEST",f="intercept/RESET",h="intercept/SET_SAVED",d="intercept/SET_TIMESTAMP",y="intercept/SET_VALIDATING",g=n(p,"resource","id"),m=n(c,"resp","resource","id"),v=n(l,"resp","resource","langcode","id"),_=n(a,"error","resource","id"),b=n(s,"resource"),k=n(f,"resource"),w=n(i,"resource","id"),x=n(h,"value","resource","id"),E=n(u,"resource","id"),j=n(d,"resource","timestamp"),R=n(y,"resource","value"),A=n(r,"data","resource","id"),S=n(o,"data","resource","id"),O=Object.freeze({request:g,receive:m,receiveTranslation:v,failure:_,purge:b,reset:k,clearErrors:w,setSaved:x,markDirty:E,setTimestamp:j,setValidating:R,add:A,edit:S}),T=Object.freeze({NAME:"intercept",DATE:"date",DATE_START:"date--start",DATE_END:"date--end",KEYWORD:"keyword",TYPE_FILE:"file--file",TYPE_SAVED_EVENT:"flagging--saved_event",TYPE_EVENT_RECURRENCE:"event_recurrence--event_recurrence",TYPE_MEDIA_FILE:"media--file",TYPE_MEDIA_IMAGE:"media--image",TYPE_MEDIA_SLIDESHOW:"media--slideshow",TYPE_MEDIA_VIDEO:"media--web_video",TYPE_EQUIPMENT:"node--equipment",TYPE_EQUIPMENT_RESERVATION:"equipment_reservation--equipment_reservation",TYPE_EVENT:"node--event",TYPE_EVENT_ATTENDANCE:"event_attendance--event_attendance",TYPE_EVENT_SERIES:"node--event_series",TYPE_EVENT_REGISTRATION:"event_registration--event_registration",TYPE_LOCATION:"node--location",TYPE_ROOM:"node--room",TYPE_ROOM_RESERVATION:"room_reservation--room_reservation",TYPE_AUDIENCE:"taxonomy_term--audience",TYPE_EQUIPMENT_TYPE:"taxonomy_term--equipment_type",TYPE_EVALUATION_CRITERIA:"taxonomy_term--evaluation_criteria",TYPE_EVENT_TYPE:"taxonomy_term--event_type",TYPE_SUBJECT:"taxonomy_term--lc_subject",TYPE_MEETING_PURPOSE:"taxonomy_term--meeting_purpose",TYPE_POPULATION_SEGMENT:"taxonomy_term--population_segment",TYPE_ROOM_TYPE:"taxonomy_term--room_type",TYPE_TAG:"taxonomy_term--tag",TYPE_USER:"user--user"}),P="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function C(e,t){return e(t={exports:{}},t.exports),t.exports}var D="object"==("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(P)&&P&&P.Object===Object&&P,q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I="object"==("undefined"==typeof self?"undefined":q(self))&&self&&self.Object===Object&&self,F=D||I||Function("return this")(),L=F.Symbol,Y=Object.prototype,N=Y.hasOwnProperty,V=Y.toString,G=L?L.toStringTag:void 0;var M=function(e){var t=N.call(e,G),n=e[G];try{e[G]=void 0;var r=!0}catch(e){}var i=V.call(e);return r&&(t?e[G]=n:delete e[G]),i},z=Object.prototype.toString;var B=function(e){return z.call(e)},K="[object Null]",W="[object Undefined]",U=L?L.toStringTag:void 0;var H=function(e){return null==e?void 0===e?W:K:U&&U in Object(e)?M(e):B(e)},Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var $=function(e){var t=void 0===e?"undefined":Q(e);return null!=e&&("object"==t||"function"==t)},J="[object AsyncFunction]",Z="[object Function]",X="[object GeneratorFunction]",ee="[object Proxy]";var te,ne=function(e){if(!$(e))return!1;var t=H(e);return t==Z||t==X||t==J||t==ee},re=F["__core-js_shared__"],ie=(te=/[^.]+$/.exec(re&&re.keys&&re.keys.IE_PROTO||""))?"Symbol(src)_1."+te:"";var oe=function(e){return!!ie&&ie in e},ae=Function.prototype.toString;var ue=function(e){if(null!=e){try{return ae.call(e)}catch(e){}try{return e+""}catch(e){}}return""},se=/^\[object .+?Constructor\]$/,ce=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var le=function(e){return!(!$(e)||oe(e))&&(ne(e)?ce:se).test(ue(e))};var pe=function(e,t){return null==e?void 0:e[t]};var fe=function(e,t){var n=pe(e,t);return le(n)?n:void 0},he=function(){try{var e=fe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var de=function(e,t,n){"__proto__"==t&&he?he(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var ye=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r};var ge=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),u=a.length;u--;){var s=a[e?u:++i];if(!1===n(o[s],s,o))break}return t}}();var me=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var _e=function(e){return null!=e&&"object"==(void 0===e?"undefined":ve(e))},be="[object Arguments]";var ke=function(e){return _e(e)&&H(e)==be},we=Object.prototype,xe=we.hasOwnProperty,Ee=we.propertyIsEnumerable,je=ke(function(){return arguments}())?ke:function(e){return _e(e)&&xe.call(e,"callee")&&!Ee.call(e,"callee")},Re=Array.isArray;var Ae=function(){return!1},Se=C(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?F.Buffer:void 0;e.exports=(i?i.isBuffer:void 0)||Ae}),Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te=9007199254740991,Pe=/^(?:0|[1-9]\d*)$/;var Ce=function(e,t){var n=void 0===e?"undefined":Oe(e);return!!(t=null==t?Te:t)&&("number"==n||"symbol"!=n&&Pe.test(e))&&e>-1&&e%1==0&&t>e},De=9007199254740991;var qe=function(e){return"number"==typeof e&&e>-1&&e%1==0&&De>=e},Ie={};Ie["[object Float32Array]"]=Ie["[object Float64Array]"]=Ie["[object Int8Array]"]=Ie["[object Int16Array]"]=Ie["[object Int32Array]"]=Ie["[object Uint8Array]"]=Ie["[object Uint8ClampedArray]"]=Ie["[object Uint16Array]"]=Ie["[object Uint32Array]"]=!0,Ie["[object Arguments]"]=Ie["[object Array]"]=Ie["[object ArrayBuffer]"]=Ie["[object Boolean]"]=Ie["[object DataView]"]=Ie["[object Date]"]=Ie["[object Error]"]=Ie["[object Function]"]=Ie["[object Map]"]=Ie["[object Number]"]=Ie["[object Object]"]=Ie["[object RegExp]"]=Ie["[object Set]"]=Ie["[object String]"]=Ie["[object WeakMap]"]=!1;var Fe=function(e){return _e(e)&&qe(e.length)&&!!Ie[H(e)]};var Le=function(e){return function(t){return e(t)}},Ye=C(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&D.process,o=function(){try{return i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}),Ne=Ye&&Ye.isTypedArray,Ve=Ne?Le(Ne):Fe,Ge=Object.prototype.hasOwnProperty;var Me=function(e,t){var n=Re(e),r=!n&&je(e),i=!n&&!r&&Se(e),o=!n&&!r&&!i&&Ve(e),a=n||r||i||o,u=a?me(e.length,String):[],s=u.length;for(var c in e)!t&&!Ge.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ce(c,s))||u.push(c);return u},ze=Object.prototype;var Be=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ze)};var Ke=function(e,t){return function(n){return e(t(n))}},We=Ke(Object.keys,Object),Ue=Object.prototype.hasOwnProperty;var He=function(e){if(!Be(e))return We(e);var t=[];for(var n in Object(e))Ue.call(e,n)&&"constructor"!=n&&t.push(n);return t};var Qe=function(e){return null!=e&&qe(e.length)&&!ne(e)};var $e=function(e){return Qe(e)?Me(e):He(e)};var Je=function(e,t){return e&&ge(e,t,$e)};var Ze=function(e,t){return function(n,r){if(null==n)return n;if(!Qe(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}(Je);var Xe=function(e,t,n,r){return Ze(e,function(e,i,o){t(r,e,n(e),o)}),r};var et=function(e,t){return e===t||e!=e&&t!=t};var tt=function(e,t){for(var n=e.length;n--;)if(et(e[n][0],t))return n;return-1},nt=Array.prototype.splice;var rt=function(e){var t=this.__data__,n=tt(t,e);return n>=0&&(n==t.length-1?t.pop():nt.call(t,n,1),--this.size,!0)};var it=function(e){var t=this.__data__,n=tt(t,e);return 0>n?void 0:t[n][1]};var ot=function(e){return tt(this.__data__,e)>-1};var at=function(e,t){var n=this.__data__,r=tt(n,e);return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this};function ut(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ut.prototype.clear=function(){this.__data__=[],this.size=0},ut.prototype.delete=rt,ut.prototype.get=it,ut.prototype.has=ot,ut.prototype.set=at;var st=ut;var ct=function(){this.__data__=new st,this.size=0};var lt=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var pt=function(e){return this.__data__.get(e)};var ft=function(e){return this.__data__.has(e)},ht=fe(F,"Map"),dt=fe(Object,"create");var yt=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},gt="__lodash_hash_undefined__",mt=Object.prototype.hasOwnProperty;var vt=function(e){var t=this.__data__;if(dt){var n=t[e];return n===gt?void 0:n}return mt.call(t,e)?t[e]:void 0},_t=Object.prototype.hasOwnProperty;var bt=function(e){var t=this.__data__;return dt?void 0!==t[e]:_t.call(t,e)},kt="__lodash_hash_undefined__";var wt=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=dt&&void 0===t?kt:t,this};function xt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}xt.prototype.clear=function(){this.__data__=dt?dt(null):{},this.size=0},xt.prototype.delete=yt,xt.prototype.get=vt,xt.prototype.has=bt,xt.prototype.set=wt;var Et=xt;var jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var Rt=function(e){var t=void 0===e?"undefined":jt(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var At=function(e,t){var n=e.__data__;return Rt(t)?n["string"==typeof t?"string":"hash"]:n.map};var St=function(e){var t=At(this,e).delete(e);return this.size-=t?1:0,t};var Ot=function(e){return At(this,e).get(e)};var Tt=function(e){return At(this,e).has(e)};var Pt=function(e,t){var n=At(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Ct(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ct.prototype.clear=function(){this.size=0,this.__data__={hash:new Et,map:new(ht||st),string:new Et}},Ct.prototype.delete=St,Ct.prototype.get=Ot,Ct.prototype.has=Tt,Ct.prototype.set=Pt;var Dt=Ct,qt=200;var It=function(e,t){var n=this.__data__;if(n instanceof st){var r=n.__data__;if(!ht||qt-1>r.length)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Dt(r)}return n.set(e,t),this.size=n.size,this};function Ft(e){var t=this.__data__=new st(e);this.size=t.size}Ft.prototype.clear=ct,Ft.prototype.delete=lt,Ft.prototype.get=pt,Ft.prototype.has=ft,Ft.prototype.set=It;var Lt=Ft,Yt="__lodash_hash_undefined__";var Nt=function(e){return this.__data__.has(e)};function Vt(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Dt;++t<n;)this.add(e[t])}Vt.prototype.add=Vt.prototype.push=function(e){return this.__data__.set(e,Yt),this},Vt.prototype.has=Nt;var Gt=Vt;var Mt=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var zt=function(e,t){return e.has(t)},Bt=1,Kt=2;var Wt=function(e,t,n,r,i,o){var a=n&Bt,u=e.length,s=t.length;if(!(u==s||a&&s>u))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,p=!0,f=n&Kt?new Gt:void 0;for(o.set(e,t),o.set(t,e);++l<u;){var h=e[l],d=t[l];if(r)var y=a?r(d,h,l,t,e,o):r(h,d,l,e,t,o);if(void 0!==y){if(y)continue;p=!1;break}if(f){if(!Mt(t,function(e,t){if(!zt(f,t)&&(h===e||i(h,e,n,r,o)))return f.push(t)})){p=!1;break}}else if(h!==d&&!i(h,d,n,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p},Ut=F.Uint8Array;var Ht=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n};var Qt=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n},$t=1,Jt=2,Zt="[object Boolean]",Xt="[object Date]",en="[object Error]",tn="[object Map]",nn="[object Number]",rn="[object RegExp]",on="[object Set]",an="[object String]",un="[object Symbol]",sn="[object ArrayBuffer]",cn="[object DataView]",ln=L?L.prototype:void 0,pn=ln?ln.valueOf:void 0;var fn=function(e,t,n,r,i,o,a){switch(n){case cn:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case sn:return!(e.byteLength!=t.byteLength||!o(new Ut(e),new Ut(t)));case Zt:case Xt:case nn:return et(+e,+t);case en:return e.name==t.name&&e.message==t.message;case rn:case an:return e==t+"";case tn:var u=Ht;case on:if(u||(u=Qt),e.size!=t.size&&!(r&$t))return!1;var s=a.get(e);if(s)return s==t;r|=Jt,a.set(e,t);var c=Wt(u(e),u(t),r,i,o,a);return a.delete(e),c;case un:if(pn)return pn.call(e)==pn.call(t)}return!1};var hn=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e};var dn=function(e,t,n){var r=t(e);return Re(e)?r:hn(r,n(e))};var yn=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o};var gn=function(){return[]},mn=Object.prototype.propertyIsEnumerable,vn=Object.getOwnPropertySymbols,_n=vn?function(e){return null==e?[]:yn(vn(e=Object(e)),function(t){return mn.call(e,t)})}:gn;var bn=function(e){return dn(e,$e,_n)},kn=1,wn=Object.prototype.hasOwnProperty;var xn=function(e,t,n,r,i,o){var a=n&kn,u=bn(e),s=u.length;if(s!=bn(t).length&&!a)return!1;for(var c=s;c--;){var l=u[c];if(!(a?l in t:wn.call(t,l)))return!1}var p=o.get(e);if(p&&o.get(t))return p==t;var f=!0;o.set(e,t),o.set(t,e);for(var h=a;++c<s;){var d=e[l=u[c]],y=t[l];if(r)var g=a?r(y,d,l,t,e,o):r(d,y,l,e,t,o);if(!(void 0===g?d===y||i(d,y,n,r,o):g)){f=!1;break}h||(h="constructor"==l)}if(f&&!h){var m=e.constructor,v=t.constructor;m!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof v&&v instanceof v)&&(f=!1)}return o.delete(e),o.delete(t),f},En=fe(F,"DataView"),jn=fe(F,"Promise"),Rn=fe(F,"Set"),An=fe(F,"WeakMap"),Sn="[object Map]",On="[object Promise]",Tn="[object Set]",Pn="[object WeakMap]",Cn="[object DataView]",Dn=ue(En),qn=ue(ht),In=ue(jn),Fn=ue(Rn),Ln=ue(An),Yn=H;(En&&Yn(new En(new ArrayBuffer(1)))!=Cn||ht&&Yn(new ht)!=Sn||jn&&Yn(jn.resolve())!=On||Rn&&Yn(new Rn)!=Tn||An&&Yn(new An)!=Pn)&&(Yn=function(e){var t=H(e),n="[object Object]"==t?e.constructor:void 0,r=n?ue(n):"";if(r)switch(r){case Dn:return Cn;case qn:return Sn;case In:return On;case Fn:return Tn;case Ln:return Pn}return t});var Nn=Yn,Vn=1,Gn="[object Arguments]",Mn="[object Array]",zn="[object Object]",Bn=Object.prototype.hasOwnProperty;var Kn=function(e,t,n,r,i,o){var a=Re(e),u=Re(t),s=a?Mn:Nn(e),c=u?Mn:Nn(t),l=(s=s==Gn?zn:s)==zn,p=(c=c==Gn?zn:c)==zn,f=s==c;if(f&&Se(e)){if(!Se(t))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new Lt),a||Ve(e)?Wt(e,t,n,r,i,o):fn(e,t,s,n,r,i,o);if(!(n&Vn)){var h=l&&Bn.call(e,"__wrapped__"),d=p&&Bn.call(t,"__wrapped__");if(h||d){var y=h?e.value():e,g=d?t.value():t;return o||(o=new Lt),i(y,g,n,r,o)}}return!!f&&(o||(o=new Lt),xn(e,t,n,r,i,o))};var Wn=function e(t,n,r,i,o){return t===n||(null==t||null==n||!_e(t)&&!_e(n)?t!=t&&n!=n:Kn(t,n,r,i,e,o))},Un=1,Hn=2;var Qn=function(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var u=n[i];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++i<o;){var s=(u=n[i])[0],c=e[s],l=u[1];if(a&&u[2]){if(void 0===c&&!(s in e))return!1}else{var p=new Lt;if(r)var f=r(c,l,s,e,t,p);if(!(void 0===f?Wn(l,c,Un|Hn,r,p):f))return!1}}return!0};var $n=function(e){return e==e&&!$(e)};var Jn=function(e){for(var t=$e(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,$n(i)]}return t};var Zn=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}};var Xn=function(e){var t=Jn(e);return 1==t.length&&t[0][2]?Zn(t[0][0],t[0][1]):function(n){return n===e||Qn(n,e,t)}},er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr="[object Symbol]";var nr=function(e){return"symbol"==(void 0===e?"undefined":er(e))||_e(e)&&H(e)==tr},rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ir=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,or=/^\w*$/;var ar=function(e,t){if(Re(e))return!1;var n=void 0===e?"undefined":rr(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!nr(e))||or.test(e)||!ir.test(e)||null!=t&&e in Object(t)},ur="Expected a function";function sr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(ur);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(sr.Cache||Dt),n}sr.Cache=Dt;var cr=sr,lr=500;var pr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fr=/\\(\\)?/g,hr=function(e){var t=cr(e,function(e){return n.size===lr&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(pr,function(e,n,r,i){t.push(r?i.replace(fr,"$1"):n||e)}),t});var dr=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},yr=1/0,gr=L?L.prototype:void 0,mr=gr?gr.toString:void 0;var vr=function e(t){if("string"==typeof t)return t;if(Re(t))return dr(t,e)+"";if(nr(t))return mr?mr.call(t):"";var n=t+"";return"0"==n&&1/t==-yr?"-0":n};var _r=function(e){return null==e?"":vr(e)};var br=function(e,t){return Re(e)?e:ar(e,t)?[e]:hr(_r(e))},kr=1/0;var wr=function(e){if("string"==typeof e||nr(e))return e;var t=e+"";return"0"==t&&1/e==-kr?"-0":t};var xr=function(e,t){for(var n=0,r=(t=br(t,e)).length;null!=e&&r>n;)e=e[wr(t[n++])];return n&&n==r?e:void 0};var Er=function(e,t,n){var r=null==e?void 0:xr(e,t);return void 0===r?n:r};var jr=function(e,t){return null!=e&&t in Object(e)};var Rr=function(e,t,n){for(var r=-1,i=(t=br(t,e)).length,o=!1;++r<i;){var a=wr(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&qe(i)&&Ce(a,i)&&(Re(e)||je(e))};var Ar=function(e,t){return null!=e&&Rr(e,t,jr)},Sr=1,Or=2;var Tr=function(e,t){return ar(e)&&$n(t)?Zn(wr(e),t):function(n){var r=Er(n,e);return void 0===r&&r===t?Ar(n,e):Wn(t,r,Sr|Or)}};var Pr=function(e){return e};var Cr=function(e){return function(t){return null==t?void 0:t[e]}};var Dr=function(e){return function(t){return xr(t,e)}};var qr=function(e){return ar(e)?Cr(wr(e)):Dr(e)},Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var Fr=function(e){return"function"==typeof e?e:null==e?Pr:"object"==(void 0===e?"undefined":Ir(e))?Re(e)?Tr(e[0],e[1]):Xn(e):qr(e)};var Lr=function(e,t){return function(n,r){var i=Re(n)?ye:Xe,o=t?t():{};return i(n,e,Fr(r,2),o)}},Yr=Lr(function(e,t,n){de(e,n,t)});var Nr=function(e,t){var n={};return t=Fr(t,3),Je(e,function(e,r,i){de(n,r,t(e,r,i))}),n},Vr=C(function(e,t){t.load=function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(n in t)i[n]=null!=(r=e[n])?r:t[n];return i},t.overwrite=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(n in e)void 0!==t[n]&&(r[n]=e[n]);return r}}),Gr=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Mr=C(function(e){var t;t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._first=null,this._last=null,this.length=0}return Gr(e,[{key:"push",value:function(e){var t;this.length++,t={value:e,next:null},null!=this._last?(this._last.next=t,this._last=t):this._first=this._last=t}},{key:"shift",value:function(){var e,t;if(null!=this._first)return this.length--,t=this._first.value,this._first=null!=(e=this._first.next)?e:this._last=null,t}},{key:"first",value:function(){if(null!=this._first)return this._first.value}},{key:"getArray",value:function(){var e,t,n;for(e=this._first,n=[];null!=e;)n.push((t=e,e=e.next,t.value));return n}}]),e}(),e.exports=t});var zr=C(function(e){var t;t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}(),e.exports=t}),Br=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Kr(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),u=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}var Wr=C(function(e){var t,n,r;r=Vr,t=zr,n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.load(t,t,this),this._nextRequest=Date.now(),this._running=0,this._executing={},this._unblockTime=0,this.ready=this.yieldLoop(),this.clients={}}return Br(e,[{key:"disconnect",value:function(e){return this}},{key:"yieldLoop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new this.Promise(function(t,n){return setTimeout(t,e)})}},{key:"computePenalty",value:function(){var e;return null!=(e=this.penalty)?e:15*this.minTime||5e3}},{key:"__updateSettings__",value:(p=Kr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return r.overwrite(t,t,this),e.abrupt("return",!0);case 4:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"__running__",value:(l=Kr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return e.abrupt("return",this._running);case 3:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"__groupCheck__",value:(c=Kr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return e.abrupt("return",this._nextRequest);case 3:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})},{key:"conditionsCheck",value:function(e){return!(null!=this.maxConcurrent&&this._running+e>this.maxConcurrent||null!=this.reservoir&&0>this.reservoir-e)}},{key:"__incrementReservoir__",value:(s=Kr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return e.abrupt("return",this.reservoir+=t);case 3:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"__currentReservoir__",value:(u=Kr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return e.abrupt("return",this.reservoir);case 3:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"isBlocked",value:function(e){return this._unblockTime>=e}},{key:"check",value:function(e,t){return this.conditionsCheck(e)&&0>=this._nextRequest-t}},{key:"__check__",value:(a=Kr(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return n=Date.now(),e.abrupt("return",this.check(t,n));case 4:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"__register__",value:(o=Kr(regeneratorRuntime.mark(function e(t,n,r){var i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:if(i=Date.now(),!this.conditionsCheck(n)){e.next=12;break}return this._running+=n,this._executing[t]={timeout:null!=r?setTimeout(function(){if(!a._executing[t].freed)return a._executing[t].freed=!0,a._running-=n},r):void 0,freed:!1},null!=this.reservoir&&(this.reservoir-=n),o=Math.max(this._nextRequest-i,0),this._nextRequest=i+o+this.minTime,e.abrupt("return",{success:!0,wait:o});case 12:return e.abrupt("return",{success:!1});case 13:case"end":return e.stop()}},e,this)})),function(e,t,n){return o.apply(this,arguments)})},{key:"strategyIsBlock",value:function(){return 3===this.strategy}},{key:"__submit__",value:(i=Kr(regeneratorRuntime.mark(function e(n,r){var i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:if(null==this.maxConcurrent||this.maxConcurrent>=r){e.next=4;break}throw new t("Impossible to add a job having a weight of "+r+" to a limiter having a maxConcurrent setting of "+this.maxConcurrent);case 4:return o=Date.now(),a=null!=this.highWater&&n===this.highWater&&!this.check(r,o),(i=this.strategyIsBlock()&&(a||this.isBlocked(o)))&&(this._unblockTime=o+this.computePenalty(),this._nextRequest=this._unblockTime+this.minTime),e.abrupt("return",{reachedHWM:a,blocked:i,strategy:this.strategy});case 9:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"__free__",value:(n=Kr(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.yieldLoop();case 2:return clearTimeout(this._executing[t].timeout),this._executing[t].freed||(this._executing[t].freed=!0,this._running-=n),e.abrupt("return",{running:this._running});case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})}]),e;var n,i,o,a,u,s,c,l,p}(),e.exports=n}),Ur={"check.lua":"local settings_key = KEYS[1]\nlocal running_key = KEYS[2]\nlocal executing_key = KEYS[3]\n\nlocal weight = tonumber(ARGV[1])\nlocal now = tonumber(ARGV[2])\n\nlocal running = tonumber(refresh_running(executing_key, running_key, settings_key, now))\nlocal settings = redis.call('hmget', settings_key,\n  'maxConcurrent',\n  'reservoir',\n  'nextRequest'\n)\nlocal maxConcurrent = tonumber(settings[1])\nlocal reservoir = tonumber(settings[2])\nlocal nextRequest = tonumber(settings[3])\n\nlocal conditionsCheck = conditions_check(weight, maxConcurrent, running, reservoir)\n\nlocal result = conditionsCheck and nextRequest - now <= 0\n\nreturn result\n","conditions_check.lua":"local conditions_check = function (weight, maxConcurrent, running, reservoir)\n  return (\n    (maxConcurrent == nil or running + weight <= maxConcurrent) and\n    (reservoir == nil or reservoir - weight >= 0)\n  )\nend\n","current_reservoir.lua":"local settings_key = KEYS[1]\n\nreturn tonumber(redis.call('hget', settings_key, 'reservoir'))\n","free.lua":"local settings_key = KEYS[1]\nlocal running_key = KEYS[2]\nlocal executing_key = KEYS[3]\n\nlocal index = ARGV[1]\nlocal now = ARGV[2]\n\nredis.call('zadd', executing_key, 0, index)\n\nreturn refresh_running(executing_key, running_key, settings_key, now)\n","get_time.lua":"redis.replicate_commands()\n\nlocal get_time = function ()\n  local time = redis.call('time')\n\n  return tonumber(time[1]..string.sub(time[2], 1, 3))\nend\n","group_check.lua":"local settings_key = KEYS[1]\n\nreturn redis.call('hget', settings_key, 'nextRequest')\n","increment_reservoir.lua":"local settings_key = KEYS[1]\nlocal incr = ARGV[1]\n\nreturn redis.call('hincrby', settings_key, 'reservoir', incr)\n","init.lua":"local settings_key = KEYS[1]\nlocal running_key = KEYS[2]\nlocal executing_key = KEYS[3]\n\nlocal clear = tonumber(ARGV[1])\n\nif clear == 1 then\n  redis.call('del', settings_key, running_key, executing_key)\nend\n\nif redis.call('exists', settings_key) == 0 then\n  local args = {'hmset', settings_key}\n\n  for i = 2, #ARGV do\n    table.insert(args, ARGV[i])\n  end\n\n  redis.call(unpack(args))\nend\n\nreturn {}\n","refresh_running.lua":"local refresh_running = function (executing_key, running_key, settings_key, now)\n\n  local expired = redis.call('zrangebyscore', executing_key, '-inf', '('..now)\n\n  if #expired == 0 then\n    return redis.call('hget', settings_key, 'running')\n  else\n    redis.call('zremrangebyscore', executing_key, '-inf', '('..now)\n\n    local args = {'hmget', running_key}\n    for i = 1, #expired do\n      table.insert(args, expired[i])\n    end\n\n    local weights = redis.call(unpack(args))\n\n    args[1] = 'hdel'\n    local deleted = redis.call(unpack(args))\n\n    local total = 0\n    for i = 1, #weights do\n      total = total + (tonumber(weights[i]) or 0)\n    end\n    local incr = -total\n    if total == 0 then\n      incr = 0\n    else\n      redis.call('publish', 'bottleneck', 'freed:'..total)\n    end\n\n    return redis.call('hincrby', settings_key, 'running', incr)\n  end\n\nend\n","register.lua":"local settings_key = KEYS[1]\nlocal running_key = KEYS[2]\nlocal executing_key = KEYS[3]\n\nlocal index = ARGV[1]\nlocal weight = tonumber(ARGV[2])\nlocal expiration = tonumber(ARGV[3])\nlocal now = tonumber(ARGV[4])\n\nlocal running = tonumber(refresh_running(executing_key, running_key, settings_key, now))\nlocal settings = redis.call('hmget', settings_key,\n  'maxConcurrent',\n  'reservoir',\n  'nextRequest',\n  'minTime'\n)\nlocal maxConcurrent = tonumber(settings[1])\nlocal reservoir = tonumber(settings[2])\nlocal nextRequest = tonumber(settings[3])\nlocal minTime = tonumber(settings[4])\n\nif conditions_check(weight, maxConcurrent, running, reservoir) then\n\n  if expiration ~= nil then\n    redis.call('zadd', executing_key, now + expiration, index)\n  end\n  redis.call('hset', running_key, index, weight)\n  redis.call('hincrby', settings_key, 'running', weight)\n\n  local wait = math.max(nextRequest - now, 0)\n\n  if reservoir == nil then\n    redis.call('hset', settings_key,\n    'nextRequest', now + wait + minTime\n    )\n  else\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir - weight,\n      'nextRequest', now + wait + minTime\n    )\n  end\n\n  return {true, wait}\n\nelse\n  return {false}\nend\n","running.lua":"local settings_key = KEYS[1]\nlocal running_key = KEYS[2]\nlocal executing_key = KEYS[3]\nlocal now = ARGV[1]\n\nreturn tonumber(refresh_running(executing_key, running_key, settings_key, now))\n","submit.lua":"local settings_key = KEYS[1]\nlocal running_key = KEYS[2]\nlocal executing_key = KEYS[3]\n\nlocal queueLength = tonumber(ARGV[1])\nlocal weight = tonumber(ARGV[2])\nlocal now = tonumber(ARGV[3])\n\nlocal running = tonumber(refresh_running(executing_key, running_key, settings_key, now))\nlocal settings = redis.call('hmget', settings_key,\n  'maxConcurrent',\n  'highWater',\n  'reservoir',\n  'nextRequest',\n  'strategy',\n  'unblockTime',\n  'penalty',\n  'minTime'\n)\nlocal maxConcurrent = tonumber(settings[1])\nlocal highWater = tonumber(settings[2])\nlocal reservoir = tonumber(settings[3])\nlocal nextRequest = tonumber(settings[4])\nlocal strategy = tonumber(settings[5])\nlocal unblockTime = tonumber(settings[6])\nlocal penalty = tonumber(settings[7])\nlocal minTime = tonumber(settings[8])\n\nif maxConcurrent ~= nil and weight > maxConcurrent then\n  return redis.error_reply('OVERWEIGHT:'..weight..':'..maxConcurrent)\nend\n\nlocal reachedHWM = (highWater ~= nil and queueLength == highWater\n  and not (\n    conditions_check(weight, maxConcurrent, running, reservoir)\n    and nextRequest - now <= 0\n  )\n)\n\nlocal blocked = strategy == 3 and (reachedHWM or unblockTime >= now)\n\nif blocked then\n  local computedPenalty = penalty\n  if computedPenalty == nil then\n    if minTime == 0 then\n      computedPenalty = 5000\n    else\n      computedPenalty = 15 * minTime\n    end\n  end\n\n  redis.call('hmset', settings_key,\n    'unblockTime', now + computedPenalty,\n    'nextRequest', unblockTime + minTime\n  )\nend\n\nreturn {reachedHWM, blocked, strategy}\n","update_settings.lua":"local settings_key = KEYS[1]\n\nlocal args = {'hmset', settings_key}\n\nfor i = 1, #ARGV do\n  table.insert(args, ARGV[i])\nend\n\nredis.call(unpack(args))\n\nreturn {}\n"},Hr=Object.freeze({default:Ur}),Qr=Hr&&Ur||Hr,$r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Jr=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Zr(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),u=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}var Xr=C(function(t){var n,r,i,o,a,u;a=Vr,n=zr,i={get_time:(o=Qr)["get_time.lua"],refresh_running:o["refresh_running.lua"],conditions_check:o["conditions_check.lua"]},u={init:{keys:["b_settings","b_running","b_executing"],libs:[],code:o["init.lua"]},update_settings:{keys:["b_settings"],libs:[],code:o["update_settings.lua"]},running:{keys:["b_settings","b_running","b_executing"],libs:["refresh_running"],code:o["running.lua"]},group_check:{keys:["b_settings"],libs:[],code:o["group_check.lua"]},check:{keys:["b_settings","b_running","b_executing"],libs:["refresh_running","conditions_check"],code:o["check.lua"]},submit:{keys:["b_settings","b_running","b_executing"],libs:["refresh_running","conditions_check"],code:o["submit.lua"]},register:{keys:["b_settings","b_running","b_executing"],libs:["refresh_running","conditions_check"],code:o["register.lua"]},free:{keys:["b_settings","b_running","b_executing"],libs:["refresh_running"],code:o["free.lua"]},current_reservoir:{keys:["b_settings"],libs:[],code:o["current_reservoir.lua"]},increment_reservoir:{keys:["b_settings"],libs:[],code:o["increment_reservoir.lua"]}},r=function(){function t(n,r,i){var o,u=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.loadAll=this.loadAll.bind(this),this.instance=n,o=e,a.load(i,i,this),this.client=o.createClient(this.clientOptions),this.subClient=o.createClient(this.clientOptions),this.shas={},this.clients={client:this.client,subscriber:this.subClient},this.ready=new this.Promise(function(e,t){var n,r,i;return n=0,r=function(){if(2==++n)return[u.client,u.subClient].forEach(function(e){return e.removeListener("error",i),e.on("error",function(e){return u.instance._trigger("error",[e])})}),e()},u.client.on("error",i=function(e){return t(e)}),u.client.on("ready",function(){return r()}),u.subClient.on("error",i),u.subClient.on("ready",function(){return u.subClient.on("subscribe",function(){return r()}),u.subClient.subscribe("bottleneck")})}).then(this.loadAll).then(function(){var e;return u.subClient.on("message",function(e,t){var n,r=t.split(":"),i=$r(r,2);if(n=i[1],"freed"===i[0])return u.instance._drainAll(~~n)}),r.nextRequest=Date.now(),r.running=0,r.unblockTime=0,r.version=u.instance.version,(e=u.prepareObject(r)).unshift(i.clearDatastore?1:0),u.runScript("init",e)}).then(function(e){return u.clients})}return Jr(t,[{key:"disconnect",value:function(e){return this.client.end(e),this.subClient.end(e),this}},{key:"loadScript",value:function(e){var t=this;return new this.Promise(function(n,r){var o;return o=u[e].libs.map(function(e){return i[e]}).join("\n")+u[e].code,t.client.multi([["script","load",o]]).exec(function(i,o){return null!=i?r(i):(t.shas[e]=o[0],n(o[0]))})})}},{key:"loadAll",value:function(){var e;return this.Promise.all(function(){var t;t=[];for(e in u)t.push(this.loadScript(e));return t}.call(this))}},{key:"prepareArray",value:function(e){return e.map(function(e){return null!=e?""+e:""})}},{key:"prepareObject",value:function(e){var t,n,r;t=[];for(n in e)t.push(n,null!=(r=e[n])?""+r:"");return t}},{key:"runScript",value:function(e,t){var n=this;return new this.Promise(function(r,i){var o,a;return o=[n.shas[e],(a=u[e]).keys.length].concat(a.keys,t,function(e,t){return null!=e?i(e):r(t)}),n.client.evalsha.bind(n.client).apply({},o)})}},{key:"convertBool",value:function(e){return!!e}},{key:"__updateSettings__",value:(d=Zr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runScript("update_settings",this.prepareObject(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"__running__",value:(h=Zr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runScript("running",[Date.now()]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"__groupCheck__",value:(f=Zr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=parseInt,e.next=3,this.runScript("group_check",[]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1,10));case 5:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"__incrementReservoir__",value:(p=Zr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runScript("increment_reservoir",[t]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"__currentReservoir__",value:(l=Zr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runScript("current_reservoir",[]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"__check__",value:(c=Zr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.runScript("check",this.prepareArray([t,Date.now()]));case 3:return e.t1=e.sent,e.abrupt("return",e.t0.convertBool.call(e.t0,e.t1));case 5:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"__register__",value:(s=Zr(regeneratorRuntime.mark(function e(t,n,r){var i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runScript("register",this.prepareArray([t,n,r,Date.now()]));case 2:return o=$r(e.sent,2),i=o[1],e.abrupt("return",{success:this.convertBool(o[0]),wait:i});case 7:case"end":return e.stop()}},e,this)})),function(e,t,n){return s.apply(this,arguments)})},{key:"__submit__",value:(o=Zr(regeneratorRuntime.mark(function e(t,r){var i,o,a,u,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.runScript("submit",this.prepareArray([t,r,Date.now()]));case 3:return u=$r(e.sent,3),i=u[1],a=u[2],e.abrupt("return",{reachedHWM:this.convertBool(u[0]),blocked:this.convertBool(i),strategy:a});case 11:if(e.prev=11,e.t0=e.catch(0),0!==(o=e.t0).message.indexOf("OVERWEIGHT")){e.next=23;break}throw s=o.message.split(":"),c=$r(s,3),new n("Impossible to add a job having a weight of "+(r=c[1])+" to a limiter having a maxConcurrent setting of "+c[2]);case 23:throw o;case 24:case"end":return e.stop()}},e,this,[[0,11]])})),function(e,t){return o.apply(this,arguments)})},{key:"__free__",value:(r=Zr(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runScript("free",this.prepareArray([t,Date.now()]));case 2:return e.abrupt("return",{running:e.sent});case 4:case"end":return e.stop()}},e,this)})),function(e,t){return r.apply(this,arguments)})}]),t;var r,o,s,c,l,p,f,h,d}(),t.exports=r}),ei=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ti=C(function(e){var t,n,r;r=[].slice,t=Mr,n=function(){function e(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.submit=this.submit.bind(this),this.schedule=this.schedule.bind(this),this.wrap=this.wrap.bind(this),this.name=n,this._running=0,this._queue=new t}return ei(e,[{key:"_tryToRun",value:function(){var e,t=this;if(1>this._running&&this._queue.length>0)return this._running++,(e=this._queue.shift()).task.apply({},e.args.concat(function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];var o;return t._running--,t._tryToRun(),null!=(o=e.cb)?o.apply({},r):void 0}))}},{key:"submit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];var o,a,u;return n=2>(u=n).length?(a=0,[]):r.call(u,0,a=u.length-1),o=u[a++],this._queue.push({task:e,args:n,cb:o}),this._tryToRun()}},{key:"schedule",value:function(e){for(var t,n=this,i=arguments.length,o=Array(i>1?i-1:0),a=1;i>a;a++)o[a-1]=arguments[a];return t=function(){for(var t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];var o,a,u;return n=2>(u=n).length?(a=0,[]):r.call(u,0,a=u.length-1),o=u[a++],e.apply({},n).then(function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return o.apply({},Array.prototype.concat(null,t))}).catch(function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return o.apply({},t)})},new Promise(function(e,r){return n.submit.apply({},Array.prototype.concat(t,o,function(){for(var t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];return(null!=n[0]?r:(n.shift(),e)).apply({},n)}))})}},{key:"wrap",value:function(e){var t=this;return function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];return t.schedule.apply({},Array.prototype.concat(e,r))}}}]),e}(),e.exports=n}),ni="bottleneck@2.0.1",ri="bottleneck@2.0.1",ii="sha512-QtKe8dc5bzZ8G7Cn3q4OySCJonKtl979DajHZoHW0at60x+hq4gT7iHtNUUlNo6CZBv6Av4z1KpcfBY/2/GHpw==",oi="/bottleneck",ai={},ui={type:"version",registry:!0,raw:"bottleneck@2.0.1",name:"bottleneck",escapedName:"bottleneck",rawSpec:"2.0.1",saveSpec:null,fetchSpec:"2.0.1"},si=["#USER","/"],ci="https://registry.npmjs.org/bottleneck/-/bottleneck-2.0.1.tgz",li="2296570b8242ab492c0eecef61224b860ac09288",pi="bottleneck@2.0.1",fi="/Users/pixelwhip/Project/intercept-client",hi={name:"Simon Grondin"},di={url:"https://github.com/SGrondin/bottleneck/issues"},yi="Distributed task scheduler and rate limiter",gi={"@types/es6-promise":"0.0.33",assert:"1.4.x",browserify:"*",coffeescript:"2.0.x","ejs-cli":"git://github.com/SGrondin/ejs-cli.git",mocha:"4.x",redis:"^2.8.0",typescript:"^2.6.2","uglify-es":"3.x"},mi="https://github.com/SGrondin/bottleneck#readme",vi=["async rate limiter","rate limiter","rate limiting","async","rate","limiting","limiter","throttle","throttling","load","ddos"],_i="lib/index.js",bi="bottleneck",ki={type:"git",url:"git+https://github.com/SGrondin/bottleneck.git"},wi={build:"./scripts/build.sh",compile:"./scripts/build.sh compile",test:"./node_modules/mocha/bin/mocha test"},xi="bottleneck.d.ts",Ei={_from:ni,_id:ri,_inBundle:!1,_integrity:ii,_location:oi,_phantomChildren:ai,_requested:ui,_requiredBy:si,_resolved:ci,_shasum:li,_spec:pi,_where:fi,author:hi,bugs:di,bundleDependencies:!1,deprecated:!1,description:yi,devDependencies:gi,homepage:mi,keywords:vi,license:"MIT",main:_i,name:bi,repository:ki,scripts:wi,typings:xi,version:"2.0.1"},ji=Object.freeze({_from:ni,_id:ri,_inBundle:!1,_integrity:ii,_location:oi,_phantomChildren:ai,_requested:ui,_requiredBy:si,_resolved:ci,_shasum:li,_spec:pi,_where:fi,author:hi,bugs:di,bundleDependencies:!1,deprecated:!1,description:yi,devDependencies:gi,homepage:mi,keywords:vi,license:"MIT",main:_i,name:bi,repository:ki,scripts:wi,typings:xi,version:"2.0.1",default:Ei}),Ri=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ai=C(function(e){var t,n;t=Vr,(n=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=this.key.bind(this),this.deleteKey=this.deleteKey.bind(this),this.limiters=this.limiters.bind(this),this.keys=this.keys.bind(this),this.startAutoCleanup=this.startAutoCleanup.bind(this),this.stopAutoCleanup=this.stopAutoCleanup.bind(this),this.updateSettings=this.updateSettings.bind(this),this.limiterOptions=n,t.load(r,this.defaults,this),this.instances={},this.Bottleneck=Di,this.startAutoCleanup()}return Ri(e,[{key:"key",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return null!=(e=this.instances[t])?e:this.instances[t]=new this.Bottleneck(this.limiterOptions)}},{key:"deleteKey",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return null!=(e=this.instances[t])&&e.disconnect(),delete this.instances[t]}},{key:"limiters",value:function(){var e,t,n;t=this.instances,n=[];for(e in t)n.push({key:e,limiter:t[e]});return n}},{key:"keys",value:function(){return Object.keys(this.instances)}},{key:"startAutoCleanup",value:function(){var e,t,n=this;return this.stopAutoCleanup(),"function"==typeof(e=this.interval=setInterval((t=regeneratorRuntime.mark(function e(){var t,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=Date.now(),r=n.instances,i=[],e.t0=regeneratorRuntime.keys(r);case 4:if((e.t1=e.t0()).done){e.next=20;break}return a=r[t=e.t1.value],e.prev=7,e.next=10,a._store.__groupCheck__();case 10:i.push(o>e.sent+n.timeout?n.deleteKey(t):void 0),e.next=18;break;case 14:e.prev=14,e.t2=e.catch(7),i.push(a._trigger("error",[e.t2]));case 18:e.next=4;break;case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}},e,n,[[7,14]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var a=e[i](o),u=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});t(u)}("next")})}),this.timeout/2)).unref?e.unref():void 0}},{key:"stopAutoCleanup",value:function(){return clearInterval(this.interval)}},{key:"updateSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.overwrite(e,this.defaults,this),null!=e.timeout)return this.startAutoCleanup()}}]),e}()).prototype.defaults={timeout:3e5},e.exports=n}),Si=ji&&Ei||ji,Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ti=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Pi(e){return Array.isArray(e)?e:Array.from(e)}function Ci(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),u=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}for(var Di=C(function(e){var t,n,r,i,o,a,u,s;s=[].slice,a=Vr,n=Wr,r=Xr,t=Mr,i=ti,o=Si,(u=function(){function e(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ready=this.ready.bind(this),this.clients=this.clients.bind(this),this.disconnect=this.disconnect.bind(this),this.chain=this.chain.bind(this),this.queued=this.queued.bind(this),this.running=this.running.bind(this),this.check=this.check.bind(this),this._drainOne=this._drainOne.bind(this),this.submit=this.submit.bind(this),this.schedule=this.schedule.bind(this),this.wrap=this.wrap.bind(this),this.updateSettings=this.updateSettings.bind(this),this.currentReservoir=this.currentReservoir.bind(this),this.incrementReservoir=this.incrementReservoir.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.removeAllListeners=this.removeAllListeners.bind(this),null==o||"object"!==(void 0===o?"undefined":Oi(o))||0!=(arguments.length>1?arguments.length-1:0))throw new e.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.");a.load(o,this.instanceDefaults,this),this._queues=this._makeQueues(),this._executing={},this._limiter=null,this._events={},this._submitLock=new i("submit"),this._registerLock=new i("register"),t=a.load(o,this.storeDefaults,{}),this._store=function(){if("local"===this.datastore)return new n(a.load(o,this.storeInstanceDefaults,t));if("redis"===this.datastore)return new r(this,t,a.load(o,this.storeInstanceDefaults,{}));throw new e.prototype.BottleneckError("Invalid datastore type: "+this.datastore)}.call(this)}return Ti(e,[{key:"ready",value:function(){return this._store.ready}},{key:"clients",value:function(){return this._store.clients}},{key:"disconnect",value:(f=Ci(regeneratorRuntime.mark(function e(){var t=0>=arguments.length||void 0===arguments[0]||arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._store.disconnect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"_addListener",value:function(e,t,n){var r;return null==(r=this._events)[e]&&(r[e]=[]),this._events[e].push({cb:n,status:t}),this}},{key:"_trigger",value:function(t,n){if("debug"!==t&&this._trigger("debug",["Event triggered: "+t,n]),"dropped"===t&&this.rejectOnDrop&&n.forEach(function(t){return t.cb.call({},new e.prototype.BottleneckError("This job has been dropped by Bottleneck"))}),null!=this._events[t])return this._events[t]=this._events[t].filter(function(e){return"none"!==e.status}),this._events[t].forEach(function(e){if("none"!==e.status)return"once"===e.status&&(e.status="none"),e.cb.apply({},n)})}},{key:"_makeQueues",value:function(){var e,n;for(n=[],e=1;10>=e;++e)n.push(new t);return n}},{key:"chain",value:function(e){return this._limiter=e,this}},{key:"_sanitizePriority",value:function(e){var t;return 0>(t=~~e!==e?5:e)?0:t>9?9:t}},{key:"_find",value:function(e,t){var n;return null!=(n=function(){var n,r,i,o;for(n=r=0,i=e.length;i>r;n=++r)if(t(o=e[n]))return o}())?n:[]}},{key:"queued",value:function(e){return null!=e?this._queues[e].length:this._queues.reduce(function(e,t){return e+t.length},0)}},{key:"running",value:(p=Ci(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._store.__running__();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})},{key:"_getFirst",value:function(e){return this._find(e,function(e){return e.length>0})}},{key:"_randomIndex",value:function(){return Math.random().toString(36).slice(2)}},{key:"check",value:(l=Ci(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._store.__check__(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"_run",value:function(t,n,r){var i,o,a,u=this;return this._trigger("debug",["Scheduling "+t.options.id,{args:t.args,options:t.options}]),o=!1,a=Ci(regeneratorRuntime.mark(function e(){for(var n=arguments.length,i=Array(n),a=0;n>a;a++)i[a]=arguments[a];var s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=20;break}return e.prev=1,o=!0,clearTimeout(u._executing[r].expiration),delete u._executing[r],u._trigger("debug",["Completed "+t.options.id,{args:t.args,options:t.options}]),e.next=8,u._store.__free__(r,t.options.weight);case 8:return c=e.sent.running,u._trigger("debug",["Freed "+t.options.id,{args:t.args,options:t.options}]),u._drainAll().catch(function(e){return u._trigger("error",[e])}),0===c&&0===u.queued()&&u._trigger("idle",[]),e.abrupt("return",null!=(s=t.cb)?s.apply({},i):void 0);case 16:return e.prev=16,e.t0=e.catch(1),e.abrupt("return",u._trigger("error",[e.t0]));case 20:case"end":return e.stop()}},e,u,[[1,16]])})),i=function(){return a.apply(this,arguments)},this._executing[r]={timeout:setTimeout(function(){return u._trigger("debug",["Executing "+t.options.id,{args:t.args,options:t.options}]),null!=u._limiter?u._limiter.submit.apply(u._limiter,Array.prototype.concat(t.options,t.task,t.args,i)):t.task.apply({},t.args.concat(i))},n),expiration:null!=t.options.expiration?setTimeout(function(){return i(new e.prototype.BottleneckError("This job timed out after "+t.options.expiration+" ms."))},t.options.expiration):void 0,job:t}}},{key:"_drainOne",value:function(e){var t=this;return this._registerLock.schedule(function(){var n,r,i,o;if(0===t.queued())return t.Promise.resolve(!1);var a=(o=t._getFirst(t._queues)).first();return i=a.options,n=a.args,null!=e&&i.weight>e?t.Promise.resolve(!1):(t._trigger("debug",["Draining "+i.id,{args:n,options:i}]),r=t._randomIndex(),t._store.__register__(r,i.weight,i.expiration).then(function(e){var a,u=e.success,s=e.wait;return t._trigger("debug",["Drained "+i.id,{success:u,args:n,options:i}]),u&&(a=o.shift(),0===t.queued()&&0===t._submitLock._queue.length&&t._trigger("empty",[]),t._run(a,s,r)),t.Promise.resolve(u)}))})}},{key:"_drainAll",value:function(e){var t=this;return this._drainOne(e).then(function(e){return e?t._drainAll():t.Promise.resolve(e)}).catch(function(e){return t._trigger("error",[e])})}},{key:"submit",value:function(){for(var t,n,r,i,o,u,c,l,p=this,f=arguments.length,h=Array(f),d=0;f>d;d++)h[d]=arguments[d];return"function"==typeof h[0]?(l=(u=h)[0],h=3>u.length?(n=1,[]):s.call(u,1,n=u.length-1),t=u[n++],o=this.jobDefaults):(o=(c=h)[0],l=c[1],h=4>c.length?(i=2,[]):s.call(c,2,i=c.length-1),t=c[i++],o=a.load(o,this.jobDefaults)),r={options:o,task:l,args:h,cb:t},o.priority=this._sanitizePriority(o.priority),this._trigger("debug",["Queueing "+o.id,{args:h,options:o}]),this._submitLock.schedule(Ci(regeneratorRuntime.mark(function t(){var n,i,a,u,s,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p._store.__submit__(p.queued(),o.weight);case 3:s=(c=t.sent).strategy,p._trigger("debug",["Queued "+o.id,{args:h,options:o,reachedHWM:a=c.reachedHWM,blocked:n=c.blocked}]),t.next=16;break;case 10:return t.prev=10,t.t0=t.catch(0),p._trigger("debug",["Could not queue "+o.id,{args:h,options:o,error:i=t.t0}]),r.cb(i),t.abrupt("return",!1);case 16:if(!n){t.next=22;break}return p._queues=p._makeQueues(),p._trigger("dropped",[r]),t.abrupt("return",!0);case 22:if(!a){t.next=27;break}if(null!=(u=s===e.prototype.strategy.LEAK?p._getFirst(p._queues.slice(o.priority).reverse()).shift():s===e.prototype.strategy.OVERFLOW_PRIORITY?p._getFirst(p._queues.slice(o.priority+1).reverse()).shift():s===e.prototype.strategy.OVERFLOW?r:void 0)&&p._trigger("dropped",[u]),null!=u&&s!==e.prototype.strategy.OVERFLOW){t.next=27;break}return t.abrupt("return",a);case 27:return p._queues[o.priority].push(r),t.next=30,p._drainAll();case 30:return t.abrupt("return",a);case 31:case"end":return t.stop()}},t,p,[[0,10]])})))}},{key:"schedule",value:function(){for(var e,t,n,r=this,i=arguments.length,o=Array(i),u=0;i>u;u++)o[u]=arguments[u];if("function"==typeof o[0]){var c=Pi(o);t=c[0],o=c.slice(1),e=this.jobDefaults}else{var l=Pi(o);e=l[0],t=l[1],o=l.slice(2),e=a.load(e,this.jobDefaults)}return n=function(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];var i,o,a;return n=2>(a=n).length?(o=0,[]):s.call(a,0,o=a.length-1),i=a[o++],t.apply({},n).then(function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return i.apply({},Array.prototype.concat(null,t))}).catch(function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return i.apply({},t)})},new this.Promise(function(t,i){return r.submit.apply({},Array.prototype.concat(e,n,o,function(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];return(null!=n[0]?i:(n.shift(),t)).apply({},n)})).catch(function(e){return r._trigger("error",[e])})})}},{key:"wrap",value:function(e){var t=this;return function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];return t.schedule.apply({},Array.prototype.concat(e,r))}}},{key:"updateSettings",value:(c=Ci(regeneratorRuntime.mark(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._store.__updateSettings__(a.overwrite(n,this.storeDefaults));case 2:return a.overwrite(n,this.instanceDefaults,this),this._drainAll().catch(function(e){return t._trigger("error",[e])}),e.abrupt("return",this);case 5:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})},{key:"currentReservoir",value:(u=Ci(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._store.__currentReservoir__();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"incrementReservoir",value:(o=Ci(regeneratorRuntime.mark(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._store.__incrementReservoir__(n);case 2:return this._drainAll().catch(function(e){return t._trigger("error",[e])}),e.abrupt("return",this);case 4:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"on",value:function(e,t){return this._addListener(e,"many",t)}},{key:"once",value:function(e,t){return this._addListener(e,"once",t)}},{key:"removeAllListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!=e?delete this._events[e]:this._events={},this}}]),e;var o,u,c,l,p,f}()).default=u,u.version=u.prototype.version=o.version,u.strategy=u.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},u.BottleneckError=u.prototype.BottleneckError=zr,u.Group=u.prototype.Group=Ai,u.prototype.jobDefaults={priority:5,weight:1,expiration:null,id:"<no-id>"},u.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:u.prototype.strategy.LEAK,penalty:null,reservoir:null},u.prototype.storeInstanceDefaults={clientOptions:{},clearDatastore:!1,Promise:Promise},u.prototype.instanceDefaults={datastore:"local",id:"<no-id>",rejectOnDrop:!0,Promise:Promise},e.exports=u}),qi=C(function(e){e.exports=Di}),Ii=function(){return t.randomBytes(16)},Fi=[],Li=0;256>Li;++Li)Fi[Li]=(Li+256).toString(16).substr(1);var Yi=function(e,t){var n=t||0;return Fi[e[n++]]+Fi[e[n++]]+Fi[e[n++]]+Fi[e[n++]]+"-"+Fi[e[n++]]+Fi[e[n++]]+"-"+Fi[e[n++]]+Fi[e[n++]]+"-"+Fi[e[n++]]+Fi[e[n++]]+"-"+Fi[e[n++]]+Fi[e[n++]]+Fi[e[n++]]+Fi[e[n++]]+Fi[e[n++]]+Fi[e[n++]]};var Ni=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||Ii)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;16>o;++o)t[r+o]=i[o];return t||Yi(i)},Vi=Object.prototype.hasOwnProperty;var Gi=function(e,t,n){var r=e[t];Vi.call(e,t)&&et(r,n)&&(void 0!==n||t in e)||de(e,t,n)};var Mi=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var u=t[o],s=r?r(n[u],e[u],u,n,e):void 0;void 0===s&&(s=e[u]),i?de(n,u,s):Gi(n,u,s)}return n};var zi=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Bi=Math.max;var Ki=function(e,t,n){return t=Bi(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Bi(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=r[i];return u[t]=n(a),zi(e,this,u)}};var Wi=function(e){return function(){return e}},Ui=800,Hi=16,Qi=Date.now;var $i=function(e){var t=0,n=0;return function(){var r=Qi(),i=Hi-(r-n);if(n=r,i>0){if(++t>=Ui)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(he?function(e,t){return he(e,"toString",{configurable:!0,enumerable:!1,value:Wi(t),writable:!0})}:Pr);var Ji=function(e,t){return $i(Ki(e,t,Pr),e+"")},Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var Xi=function(e,t,n){if(!$(n))return!1;var r=void 0===t?"undefined":Zi(t);return!!("number"==r?Qe(n)&&Ce(t,n.length):"string"==r&&t in n)&&et(n[t],e)};var eo=Object.prototype.hasOwnProperty,to=function(e){return Ji(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Xi(n[0],n[1],a)&&(o=3>i?void 0:o,i=1),t=Object(t);++r<i;){var u=n[r];u&&e(t,u,r,o)}return t})}(function(e,t){if(Be(t)||Qe(t))Mi(t,$e(t),e);else for(var n in t)eo.call(t,n)&&Gi(e,n,t[n])});var no=function(e,t){var n=[];return Ze(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n};var ro=function(e,t){return(Re(e)?yn:no)(e,Fr(t,3))};var io=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e};var oo=function(e){return"function"==typeof e?e:Pr};var ao=function(e,t){return(Re(e)?io:Ze)(e,oo(t))},uo=Object.prototype.hasOwnProperty,so=Lr(function(e,t,n){uo.call(e,n)?e[n].push(t):de(e,n,[t])});var co=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n};var lo=function(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n};var po=function(e,t,n){var r=Re(e)?co:lo,i=3>arguments.length;return r(e,Fr(t,4),n,i,Ze)};function fo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.2;return new Promise(function(i,o){var a=0;!function u(){var s,c=(s=r,Math.floor(n*Math.pow(2,a)*(1+s*(2*Math.random()-1))));e().then(function(e){i(e)}).catch(function(e){t>a?(a+=1,setTimeout(function(){u()},c)):o(e)})}()})}var ho=function(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r};var yo=function(e,t){return ho(e,Fr(t,3),Je)};var go=function(e,t,n,r){if(!$(e))return e;for(var i=-1,o=(t=br(t,e)).length,a=o-1,u=e;null!=u&&++i<o;){var s=wr(t[i]),c=n;if(i!=a){var l=u[s];void 0===(c=r?r(l,s,u):void 0)&&(c=$(l)?l:Ce(t[i+1])?[]:{})}Gi(u,s,c),u=u[s]}return e};var mo=function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],u=xr(e,a);n(u,a)&&go(o,br(a,e),u)}return o},vo=Ke(Object.getPrototypeOf,Object),_o=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)hn(t,_n(e)),e=vo(e);return t}:gn;var bo=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},ko=Object.prototype.hasOwnProperty;var wo=function(e){if(!$(e))return bo(e);var t=Be(e),n=[];for(var r in e)("constructor"!=r||!t&&ko.call(e,r))&&n.push(r);return n};var xo=function(e){return Qe(e)?Me(e,!0):wo(e)};var Eo=function(e){return dn(e,xo,_o)};var jo=function(e,t){if(null==e)return{};var n=dr(Eo(e),function(e){return[e]});return t=Fr(t),mo(e,n,function(e,n){return t(e,n[0])})};var Ro=function(e,t){var n=-1,r=Qe(e)?Array(e.length):[];return Ze(e,function(e,i,o){r[++n]=t(e,i,o)}),r};var Ao=function(e,t){return(Re(e)?dr:Ro)(e,Fr(t,3))},So=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Oo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var To=function(){function e(t,n){Oo(this,e),this.type=t,this.schema=n}return So(e,[{key:"setValue",value:function(e,t){var n=new this.constructor;return"string"==typeof e?n.setField(e,t):ao(e,function(e,t){n.setField(t,e)}),to(new this.constructor,this,n)}},{key:"setField",value:function(e,t){var n=this.schema;if(e in n==!1)return this;switch(n.type){case"relationship":this.relationships[e]={data:{type:n[e].ref,id:t}};break;default:this.attributes[e]=t}}}]),e}();var Po=function e(t){var n=this;Oo(this,e),this._data={type:t.type,attributes:{},relationships:{}},ao(t.schema,function(e,t){var r,i,o,a,u,s,c,l,p,f,h;Object.defineProperty(n,e.alias?e.alias:t,{get:"relationship"===e.type?(p=n,f=t,h=e.multiple,function(){if(f in p._data.relationships!=0)return h?Ao(p._data.relationships[f].data,function(e){return e?e.id:e}):p._data.relationships[f].data?p._data.relationships[f].data.id:p._data.relationships[f].data}):(c=n,l=t,function(){return c._data.attributes[l]}),set:"relationship"===e.type?(o=n,a=t,u=e.ref,s=e.multiple,function(e){if(a in o._data.relationships==0&&(o._data.relationships[a]={}),s){var t=[].concat(e);return o._data.relationships[a].data=Ao(t,function(e){return{type:u,id:e}})}return o._data.relationships[a].data={type:u,id:e}}):(r=n,i=t,function(e){return r._data.attributes[i]=e})})})},Co=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Do=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.manifest={},this.register=this.register.bind(this),this.getByResource=this.get.bind(this)}return Co(e,[{key:"register",value:function(e,t){this.manifest[e]=t}},{key:"get",value:function(e){return this.manifest[e]}}]),e}(),qo=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Io=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Fo=new Do("entityManagers");var Lo=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=t+"--"+n;this.type=t,this.bundle=n,this.resource=i,this.schema=r,this.jsonApiSchema=new To(i,r),this.model=new Po(this.jsonApiSchema),this.getDependentFields=this.getDependentFields.bind(this),this.dependentFields=this.getDependentFields(),this.getFields=this.getFields.bind(this),Fo.register(i,this)}return Io(e,[{key:"getDependentUuids",value:function(e,t){var n,r=this.dependentFields,i=(n=t,function(e,t){return n[e].items[t]})(this.resource,e);return r.reduce(function(e,t){return e.concat([].concat(i.data[t]).filter(function(e){return e}))},[])}},{key:"getFields",value:function(e){var t=this.schema,n=Object.keys(t);return e?n.map(function(e){return t[e].alias||e}):n}},{key:"getDependentFields",value:function(){var e=this.schema;return Object.keys(e).filter(function(t){return e[t].dependency}).map(function(t){return e[t].alias||t})}},{key:"getRelationships",value:function(){return $e(jo(this.schema,function(e){return"relationship"===e.type}))}},{key:"getRelationshipAliases",value:function(){var e=this;return this.getRelationships().map(function(t){return e.getPropertyAlias(t)})}},{key:"getPropertyAlias",value:function(e){return e in this.schema&&"alias"in this.schema[e]?this.schema[e].alias:e}},{key:"getPropertyFromAlias",value:function(e){return yo(this.schema,function(t){return"alias"in t&&t.alias===e})||e}}],[{key:"create",value:function(e){var t=e.attributes.uuid||Ni(),n=Object.assign({},e);return n.attributes=n.attributes||{},n.attributes.uuid=t,{id:t,data:n,state:{saved:!1,syncing:null,error:null,dirty:!0}}}},{key:"import",value:function(e){return e}},{key:"export",value:function(e){var t=qo({},e.data);return["created","changed","nid","tid","id"].forEach(function(e){delete t.attributes[e]}),["node_type"].forEach(function(e){delete t.relationships[e]}),{data:t}}}]),e}(),Yo=arguments;var No={canLog:null,canApply:null,canGroup:null,canError:null};No.debugSettings=!1,No.init=function(){No.canLog=void 0!==console&&void 0!==console.log,No.canApply=void 0!==console.log.apply,No.canGroup=void 0!==console.group,No.canError=void 0!==console.error},No.log=function(){var e="master",t=Array.prototype.slice.call(Yo);if(null===No.canLog&&No.init(),Yo.length>1&&"string"==typeof Yo[0]&&void 0!==No.debugSettings[Yo[0]]&&(e=Yo[0],t.shift()),void 0!==No.debugSettings[e]&&No.debugSettings[e]&&No.canLog){var n;if(No.canApply)return(n=console).log.apply(n,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return Array.from(e)}(t));console.log(t)}},No.group=function(){var e="master",t=Array.prototype.slice.call(Yo);null===No.canLog&&No.init(),Yo.length>1&&"string"==typeof Yo[0]&&void 0!==No.debugSettings[Yo[0]]&&(e=Yo[0],t.shift()),void 0!==No.debugSettings[e]&&No.debugSettings[e]&&No.canGroup&&console.group(t)},No.groupEnd=function(){var e="master",t=Array.prototype.slice.call(Yo);null===No.canLog&&No.init(),Yo.length>1&&"string"==typeof Yo[0]&&void 0!==No.debugSettings[Yo[0]]&&(e=Yo[0],t.shift()),void 0!==No.debugSettings[e]&&No.debugSettings[e]&&No.canGroup&&console.groupEnd(t)},No.error=function(){var e="master",t=Array.prototype.slice.call(Yo);null===No.canError&&No.init(),Yo.length>1&&"string"==typeof Yo[0]&&void 0!==No.debugSettings[Yo[0]]&&(e=Yo[0],t.shift()),void 0!==No.debugSettings[e]&&No.debugSettings[e]&&No.canError&&console.error(t)};var Vo=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Go=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Mo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zo=require("url"),Bo=require("url-parse"),Ko=new Do("api"),Wo=(new qi({maxConcurrent:4,minTime:250}),new qi({maxConcurrent:6,minTime:1e3/6})),Uo=new qi({maxConcurrent:2,minTime:1e3/3});new qi({maxConcurrent:1,minTime:1e3/3});function Ho(e,t,n){return function(e){if(e.ok)t(e);else switch(e.status){case 403:case 404:case 409:t(e);break;default:n(Error(""+e.status))}}}function Qo(e,t,n){return function(e){No.log("network","Rejected fetch",e),n(e)}}function $o(e){return function(t){var n=so(t,function(e){return e.type});ao(n,function(t,n){e(m({data:t.map(Lo.import)},n))})}}function Jo(e,t,n,r,i,o){return No.log("network","Response",e,r,o),e.ok?(a=n,u=r,s=o,e.json().then(function(e){No.group("network","response"),No.log("network","Response: "+u,e);var t="data"in e?e.data:e,n={data:Array.isArray(t)?t.map(Lo.import):Lo.import(t)};return No.log("network",n.data),No.groupEnd("network","response"),"included"in e&&$o(a)(e.included),a(m(n,u,s))})):(l=t,p=n,f=r,h=o,(c=e).json().then(function(e){No.log("network","Failed json response",e);var t=e||c.status+": "+(c.statusText||"No status message provided");return"PATCH"===l.method&&404===c.status?(p(_(t,f,h)),p(x(!1,f,h))):"POST"===l.method&&409===c.status?(p(_(t,f,h)),p(x(!0,f,h))):p(_(t,f,h))}).catch(function(e){return p(_(e,f,h))}));var a,u,s,c,l,p,f,h}function Zo(e,t,n){return function(r){var i="There has been a problem with your connection: "+r.message;e(_(i,t,n)),No.log("network",i,r)}}var Xo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.model;this.model=n,this.type=n.type,this.bundle=n.bundle,this.resource=n.resource,this.fields=Mo({},n.resource,n.getFields(!1)),this.include=t.include||[],this.namespace=t.namespace||"jsonapi",this.priority=t.priority||9,this.latestFetch=null,this.getLatestFetch=this.getLatestFetch.bind(this),this.setLatestFetch=this.setLatestFetch.bind(this),this.getEndpoint=this.getEndpoint.bind(this),this.getEndpointPath=this.getEndpointPath.bind(this),this.getRelationshipEndpoint=this.getRelationshipEndpoint.bind(this),this.getTimestampEndpoint=this.getTimestampEndpoint.bind(this),this.fetchAll=this.fetchAll.bind(this),this.fetchResource=this.fetchResource.bind(this),this.fetchTranslations=this.fetchTranslations.bind(this),this.sync=this.sync.bind(this),this.updateRelationshipsIfNeeded=this.updateRelationshipsIfNeeded.bind(this),this.backoffFetch=this.backoffFetch.bind(this),this.wrapFetch=this.wrapFetch.bind(this),Ko.register(n.resource,this)}return Go(e,[{key:"getEndpointPath",value:function(){return[this.namespace,this.type,this.bundle].join("/")}},{key:"getEndpointQueryParams",value:function(e){var t=e.params||{},n=e.filters?this.constructor.getEndpointFilters(e.filters):{},r=this.constructor.getEndpointFields(e.fields||null===e.fields||this.fields||{}),i=e.include?this.constructor.getEndpointInclude(e.include):{},o=e.sort?this.constructor.getEndpointSort(e.sort):{},a=e.limit?this.constructor.getEndpointLimit(e.limit):{},u=e.offset?this.constructor.getEndpointOffset(e.offset):{};return to(t,n,r,a,i,u,o)}},{key:"getEndpoint",value:function(e){var t=this.constructor.getEndpointOrigin(),n=[""];e.lang&&n.push(e.lang),n.push(this.getEndpointPath()),e.id&&n.push(e.id);var r=n.join("/"),i=this.getEndpointQueryParams({params:e.params,fields:e.fields,filters:e.filters,include:e.include,limit:e.limit,offset:e.offset,sort:e.sort});return zo.format({origin:t,pathname:r,query:i})}},{key:"getRelationshipEndpoint",value:function(e){var t=this.constructor.getEndpointOrigin(),n=[""];e.lang&&n.push(e.lang),n.push(this.getEndpointPath()),n.push(e.id),n.push("relationships"),n.push(e.relationship);var r=n.join("/"),i=this.getEndpointQueryParams({params:e.params,fields:e.fields,filters:e.filters,include:e.include});return zo.format({origin:t,pathname:r,query:i})}},{key:"getTimestampEndpoint",value:function(){var e=this.constructor.getEndpointOrigin();return zo.format({origin:e,pathname:"intercept/time"})}},{key:"getLatestFetch",value:function(){return this.latestFetch}},{key:"setLatestFetch",value:function(e){return this.latestFetch=e,e}},{key:"fetcher",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=void 0,r=0,i=!1,o=t.replace||!1;return{next:function(){return e.fetchAll(Vo({},t,{endpoint:n,totalFetched:r,replace:o,onNext:function(e,t){n=e,r=t,o=!1},onDone:function(){t.onDone&&t.onDone(),i=!0}}))},isDone:function(){return i}}}},{key:"fetchAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.backoffFetch,r=this.resource,i=this.getLatestFetch,o=this.constructor.fetchTimestamp,a=this.constructor,u=a.getRequest,s=a.getTimestamp,c=(0,this.setLatestFetch)(Ni()),l=t.filters||[],p=t.include||[],f=t.sort||[],h=t.count||0,d=t.totalFetched||0,y=t.fields,v=t.limit,k=t.offset,w=t.onNext,x=t.onDone,E=this.fetchAll.bind(this),R=t.replace||!1;return function(a,A){var S=A();t.recent&&S[r].updated&&l.push({path:"changed",value:S[r].updated,operator:">"});var O,T,P=t.endpoint||e.getEndpoint({filters:l,include:p,fields:y,sort:f,limit:v,offset:k}),C=u(P,t);return a(g(r)),No.log("network","Request",C),O=o(A).then(function(e){return e}).catch(function(e){No.log(e)}),T=n(C,Ho,Qo).then(function(e){return e.ok?e.json().then(function(e){if(!R||c===i()){var n={data:[].concat(e.data)};d+=n.data.length,No.group("network","response"),No.log("network","Response: "+s()+" "+r,e),No.log("network",n.data),No.groupEnd("network","response"),"included"in e&&$o(a)(e.included),R&&(a(b(r)),R=!1),a(m(n,r)),e.links&&e.links.next?0===h||h>d?a(E(Vo({},t,{endpoint:e.links.next,totalFetched:d,replace:R}))):w&&w(e.links.next,d):x&&x()}}):a(_(e.status+": "+(e.statusText||"No status message provided"),r)),e}).catch(Zo(a,r)),Promise.all([O,T]).then(function(e){return a(j(r,e[0])),e[1]}).catch(function(e){No.log(e)})}}},{key:"fetchResource",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.backoffFetch,i=this.resource,o=this.constructor,a=o.getRequest,u=o.getTimestamp,s=n.include||[],c=n.fields;return function(o){var l,p=n.endpoint||t.getEndpoint({include:s,fields:c,id:e}),f=a(p,n);return o(g(i,e)),No.log("network","Request",f),l=r(f,Ho,Qo).then(function(t){return t.ok?t.json().then(function(t){var n={data:t.data};No.group("network","response"),No.log("network","Response: "+u()+" "+i,t),No.log("network",n.data),No.groupEnd("network","response"),"included"in t&&$o(o)(t.included),o(m(n,i,e))}):o(_(t.status+": "+(t.statusText||"No status message provided"),i,e)),t}).catch(Zo(o,i,e)),Promise.all([l]).then(function(e){return e[1]}).catch(function(e){No.log(e)})}}},{key:"fetchTranslations",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.backoffFetch,r=this.fields,i=this.include,o=this.resource,a=this.priority,u=this.constructor,s=u.getRequest,c=u.getTimestamp,l=this.fetchTranslations.bind(this);return function(u,p){if(!p().userData.auth.loggedIn)return No.log("network","User is logged out: Aborting request."),Promise.resolve("Aborted");var f=t.limit,h=t.offset,d=t.endpoint||e.getEndpoint({fields:r,include:i,langcode:t.langcode,filters:[].concat(t.filters,{path:"langcode",value:t.langcode,operator:"="}),limit:f,offset:h}),y=s(d,t);return u(g(o)),No.log("network","Request",y),n(y,Ho,Qo).then(function(e){return e.ok?e.json().then(function(e){var n={data:[].concat(e.data).map(Lo.import)};No.group("network","response"),No.log("network","Priority: "+a),No.log("network","Translation Response: "+c()+" "+t.langcode+" "+o,e),No.log("network",n.data),No.groupEnd("network","response"),u(v(n,o,t.langcode)),e.links&&e.links.next&&u(l({endpoint:e.links.next,langcode:t.langcode}))}):u(_(e.status+": "+(e.statusText||"No status message provided"),o)),e}).catch(Zo(u,o))}}},{key:"clearErrors",value:function(){var e=this.resource;return No.log("network","Running Clear errors on "+e+"."),function(t){t(w(e))}}},{key:"markDirty",value:function(){var e=this.resource;return No.log("network","Marking all "+e+" items as dirty."),function(t){t(E(e))}}},{key:"purge",value:function(){var e=this.resource;return function(t){t(b(e))}}},{key:"reset",value:function(){var e=this.resource;return function(t){t(k(e))}}},{key:"removeRelationship",value:function(e,t){var n=this.backoffFetch,r=this.bundle,i=this.resource,o=this.type,a=this.constructor,u=a.getRequest,s=a.getRelationshipEndpoint;return function(a,c){var l=c()[i].items[t];if(l.state.syncing||l.state.error)return Promise.resolve("Aborted");var p=s({type:o,bundle:r,relationship:e,uuid:t}),f=u(p,{method:"PATCH",body:JSON.stringify({data:null})});return No.log("network","PATCH",f),a(g(i,t)),n(f,Ho,Qo).then(function(e){return Jo(e,f,a,i,0,t)}).catch(Zo(a,i,t))}}},{key:"sync",value:function(e,t){var n=this,r=this.backoffFetch,i=this.include,o=this.resource,a=this.constructor.getRequest,u=this.updateRelationshipsIfNeeded.bind(this);return function(s,c){var l=c(),p=l[o].items[e];if(p.state.syncing)return Promise.reject(Error("Entity already syncing."));if(p.state.error)return Promise.reject(Error("Will not retry a request with an error state."));var f=p.state.saved,h=f?"PATCH":"POST",d=Lo.export(p,l),y={include:i};f&&to(y,{id:e});var m=t.endpoint||n.getEndpoint(y),v=a(m,Vo({},t,{method:h,body:JSON.stringify(d)}));return No.log("network",h,v),s(g(o,e)),r(v,Ho,Qo).then(function(t){return Jo(t,v,s,o,0,e)}).then(function(e){if(f)return u(s,p.data,e.resp.data)}).catch(function(t){return No.log("network","we give up",t),Zo(s,o,e)(t),Promise.reject(t)})}}},{key:"updateRelationshipsIfNeeded",value:function(e,t,n){var r=this,i=this.model.getRelationshipAliases(),o=ro(i,function(e){return!t[e]&&t[e]!==n[e]}),a=this.removeRelationship.bind(this);return Promise.all(o.map(function(n){return e(a(r.model.getPropertyFromAlias(n),t.uuid))}))}},{key:"wrapFetch",value:function(e){var t=this.priority;return function(){return("GET"===e.method?Wo:Uo).schedule({priority:t},function(){return new Promise(function(t,n){fetch(e.clone()).then(Ho(0,t,n)).catch(Qo(0,0,n))})},e)}}},{key:"backoffFetch",value:function(e){return fo(this.wrapFetch(e))}}],[{key:"getEndpointOrigin",value:function(e){return e?new Bo(zo.format(e)).origin:"/"}},{key:"getEndpointFilters",value:function(e){return po(e,function(e,t,n){var r=to({},e),i=t.type||"condition";return"operator"in t==!1&&"condition"in t==!1&&"memberOf"in t==!1&&"type"in t==!1?(r["filter["+t.path+"][value]"]=t.value,r):"group"===i?(r["filter["+n+"][group][conjunction]"]=t.conjunction||"AND","memberOf"in t&&(r["filter["+n+"][group][memberOf]"]=t.memberOf),r):(r["filter["+n+"][condition][path]"]=t.path,["IN","NOT IN","BETWEEN"].indexOf(t.operator)>-1?r["filter["+n+"][condition][value][]"]=t.value:r["filter["+n+"][condition][value]"]=t.value,"operator"in t&&(r["filter["+n+"][condition][operator]"]=t.operator),"memberOf"in t&&(r["filter["+n+"][condition][memberOf]"]=t.memberOf),r)},{})}},{key:"getEndpointSort",value:function(e){var t=po(e,function(e,t){var n=""+("DESC"===t.direction?"-":"")+t.path;return e?[].concat(e,n).join(","):n},null);return null===t?{}:{sort:t}}},{key:"getEndpointFields",value:function(e){return null===e?{}:po(e,function(e,t,n){return to(e,Mo({},"fields["+n+"]",t.join(",")))},{})}},{key:"getEndpointInclude",value:function(e){return Array.isArray(e)&&e.length>0?{include:e.join(",")}:{}}},{key:"getEndpointLimit",value:function(e){return e?{"page[limit]":e}:{}}},{key:"getEndpointOffset",value:function(e){return e?{"page[offset]":e}:{}}},{key:"getTimestamp",value:function(){return Math.floor(new Date/1e3)}},{key:"getRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={method:t.method||"GET",headers:to({},{Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json"},t.headers||{}),credentials:"same-origin"};return t.body&&to(n,{body:t.body}),new Request(e,n)}},{key:"fetchTimestamp",value:function(){return Promise.resolve(Math.floor((new Date).getTime()/1e3))}}]),e}(),ea={items:{},validating:!1,syncing:!1,error:null,updated:null};function ta(e){return{data:e,state:{syncing:!1,saved:!0,error:null,dirty:!1}}}function na(e,t){var n=to({},e);return n.data=Vo({},e.data,t),n.state=Vo({},e.state,{error:null,dirty:!0}),n}function ra(e,t,n){if(t[e]||n[e])return Vo({},t[e],n[e])}function ia(e,t){var n=Object.assign({},e);return n.data=e.data||{},n.data.attributes=ra("attributes",e.data,t),n.data.relationships=ra("relationships",e.data,t),n.data.meta=ra("meta",e.data,t),n.data.links=ra("links",e.data,t),n.state=Vo({},e.state,{saved:!0}),n}function oa(e,t,n){var r=to({},e);return ao(t,function(t){r[t.id]=function(e,t,n){switch(n){case"mergeNew":return t.id in e?e[t.id]:ta(t);default:return t.id in e?ia(e[t.id],t):ta(t)}}(e,t,n)}),r}function aa(e,t,n,r){var i=to({},e);return ao(t,function(t){var n,o,a;i[t.uuid]&&(i[t.uuid]=(o=r,(a=to({},e[(n=t).uuid])).data.translations=to("translations"in a.data?a.data.translations:{},Mo({},o,n)),a))}),i}function ua(){var e,t,n,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ea,l=arguments[1],f=arguments[2],d=l.id,y=l.data,g={};if(d in s==!1&&0>[r,c].indexOf(l.type))return s;switch(g=to({},s[d]),l.type){case i:g.state=Vo({},g.state,{dirty:g.state.dirty||null!==g.state.error||g.state.syncing||!1,syncing:!1,error:null});break;case h:g.state=Vo({},g.state,{dirty:!0,error:null,saved:l.value});break;case u:g.state=Vo({},g.state,{dirty:!0});break;case p:g.state=Vo({},g.state,{syncing:!0,dirty:!1});break;case c:d in s==!1?(g.data=l.resp.data,g.state={dirty:!1,saved:!0,syncing:!1,error:null}):(l.resp.data&&!g.state.dirty&&(g="mergeNew"===f?(t=l.resp.data,(n=to({},e=g)).data=e.data,["created","changed","id"].forEach(function(e){t[e]&&(n.data[e]=t[e])}),n.state=Vo({},e.state,{saved:!0}),n):ia(g,l.resp.data)),g.state=Vo({},g.state,{saved:!0,syncing:!1,error:null}));break;case a:g.state=Vo({},g.state,{syncing:!1,error:l.error,dirty:!0});break;case r:g.data=y,g.state={saved:!1,syncing:!1,error:null,dirty:!0};break;case o:g=na(g,y)}return to({},s,Mo({},d,g))}function sa(e,t){return function(){var n,g,m,v,_,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ea,k=arguments[1];if(-1===[i,h,y,p,c,l,a,u,s,f,d,r,o].indexOf(k.type))return b;if(k.resource!==e)return b;if(!k.id)switch(k.type){case i:return Vo({},b,{items:(_=b.items,Nr(_,function(e){return Vo({},e,{state:Vo({},e.state,{dirty:e.state.dirty||null!==e.state.error||e.state.syncing||!1,syncing:!1,error:null})})})),syncing:!1,error:null});case u:return Vo({},b,{items:(v=b.items,Nr(v,function(e){return Vo({},e,{state:Vo({},e.state,{dirty:!0})})}))});case p:return Vo({},b,{syncing:!0});case d:return Vo({},b,{updated:k.timestamp});case c:return Vo({},b,{items:oa(b.items,k.resp.data,t),syncing:!1,error:null});case l:return Vo({},b,{items:aa(b.items,k.resp.data,0,k.langcode),syncing:!1,error:null});case s:return Vo({},b,{items:{},syncing:!1,error:null,updated:null});case a:return Vo({},b,{isFetching:!1,error:k.error});case f:return Vo({},b,{syncing:!1,error:null,updated:null});case y:return Vo({},b,{validating:k.value});case o:return Vo({},b,{items:(n=b.items,g=k.data,m=to({},n),ao(g,function(e){m[e.uuid]=na(n[e.uuid],e)}),m)});default:return b}return Vo({},b,{items:ua(b.items,k,t)})}}var ca={"evaluation_criteria--evaluation_criteria":{id:{type:"integer"},uuid:{type:"string"},text:{type:"string"},evaluation:{type:"integer"},status:{type:"boolean"},created:{type:"number"},changed:{type:"number"},author:{type:"relationship",model:"user--user",multiple:!1}},"file--file":{fid:{type:"integer"},uuid:{type:"string"},filename:{type:"string"},uri:{type:"uri"},filemime:{type:"string"},filesize:{type:"integer"},status:{type:"boolean"},created:{type:"number"},changed:{type:"number"},url:{type:"string"},uid:{type:"relationship",model:"user--user",multiple:!1}},"flagging--saved_event":{id:{type:"integer"},uuid:{type:"string"},entity_type:{type:"string"},entity_id:{type:"integer"},global:{type:"boolean"},session_id:{type:"integer"},created:{type:"number"},flagged_entity:{type:"relationship",model:"node--event",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1}},"event_registration--event_registration":{title:{type:"string"},id:{type:"integer"},uuid:{type:"string"},created:{type:"number"},changed:{type:"number"},status:{type:"string"},author:{type:"relationship",model:"user--user",multiple:!1},field_event:{type:"relationship",model:"node--event",multiple:!1},field_registrants:{type:"relationship",model:"taxonomy_term--population_segment",multiple:!0},field_user:{type:"relationship",model:"user--user",multiple:!1}},"event_attendance--event_attendance":{title:{type:"string"},id:{type:"integer"},uuid:{type:"string"},created:{type:"number"},changed:{type:"number"},status:{type:"string"},author:{type:"relationship",model:"user--user",multiple:!1},field_event:{type:"relationship",model:"node--event",multiple:!1},field_attendees:{type:"relationship",model:"taxonomy_term--population_segment",multiple:!0},field_user:{type:"relationship",model:"user--user",multiple:!1}},"event_recurrence--event_recurrence":{id:{type:"integer"},uuid:{type:"string"},created:{type:"number"},changed:{type:"number"},author:{type:"relationship",model:"user--user",multiple:!1}},"media--file":{mid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},name:{type:"string"},created:{type:"number"},changed:{type:"number"},path:{type:"object"},thumbnail:{type:"relationship",model:"file--file",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},field_media_file:{type:"relationship",model:"file--file",multiple:!1}},"media--image":{mid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},name:{type:"string"},created:{type:"number"},changed:{type:"number"},path:{type:"object"},field_media_caption:{type:"object"},field_media_credit:{type:"object"},thumbnail:{type:"relationship",model:"file--file",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},field_media_image:{type:"relationship",model:"file--file",multiple:!1}},"media--slideshow":{mid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},name:{type:"string"},created:{type:"number"},changed:{type:"number"},path:{type:"object"},thumbnail:{type:"relationship",model:"file--file",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},field_media_slideshow:{type:"relationship",model:"media--image",multiple:!0}},"media--web_video":{mid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},name:{type:"string"},created:{type:"number"},changed:{type:"number"},path:{type:"object"},field_media_caption:{type:"object"},field_media_video_embed_field:{type:"string"},thumbnail:{type:"relationship",model:"file--file",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1}},"node--equipment":{nid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},title:{type:"string"},created:{type:"number"},changed:{type:"number"},promote:{type:"boolean"},sticky:{type:"boolean"},path:{type:"object"},field_duration_min:{type:"string"},field_text_content:{type:"object"},type:{type:"relationship",model:"node_type--node_type",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},field_equipment_type:{type:"relationship",model:"taxonomy_term--equipment_type",multiple:!1},image_primary:{type:"relationship",model:"media--image",multiple:!1}},"node--event":{nid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},title:{type:"string"},created:{type:"number"},changed:{type:"number"},promote:{type:"boolean"},sticky:{type:"boolean"},path:{type:"object"},field_capacity_max:{type:"integer"},field_waitlist_max:{type:"integer"},field_date_time:{type:"object"},field_event_is_template:{type:"boolean"},field_event_register_period:{type:"object"},field_featured:{type:"boolean"},field_has_waitlist:{type:"boolean"},field_must_register:{type:"boolean"},field_text_content:{type:"object"},field_text_intro:{type:"object"},field_text_teaser:{type:"string"},field_evanced_id:{type:"string"},registration:{type:"object"},type:{type:"relationship",model:"node_type--node_type",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},field_event_audience:{type:"relationship",model:"taxonomy_term--audience",multiple:!0},field_event_audience_primary:{type:"relationship",model:"taxonomy_term--audience",multiple:!1},field_event_recurrence:{type:"relationship",model:"event_recurrence--event_recurrence",multiple:!1},field_event_series:{type:"relationship",model:"node--event_series",multiple:!1},field_event_tags:{type:"relationship",model:"taxonomy_term--tag",multiple:!0},field_event_type:{type:"relationship",model:"taxonomy_term--event_type",multiple:!0},field_event_type_primary:{type:"relationship",model:"taxonomy_term--event_type",multiple:!1},image_primary:{type:"relationship",model:"media--image",multiple:!1},field_location:{type:"relationship",model:"node--location",multiple:!1},field_room:{type:"relationship",model:"node--room",multiple:!1}},"node--event_series":{nid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},title:{type:"string"},created:{type:"number"},changed:{type:"number"},promote:{type:"boolean"},sticky:{type:"boolean"},path:{type:"object"},type:{type:"relationship",model:"node_type--node_type",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1}},"node--location":{nid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},title:{type:"string"},field_location_abbreviation:{type:"string"},created:{type:"number"},changed:{type:"number"},promote:{type:"boolean"},sticky:{type:"boolean"},path:{type:"object"},field_address:{type:"object"},field_affiliated:{type:"boolean"},field_contact_number:{type:"string"},field_features:{type:"string"},field_location_hours:{type:"array"},field_map_link:{type:"object"},field_text_content:{type:"object"},field_text_intro:{type:"object"},type:{type:"relationship",model:"node_type--node_type",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},image_primary:{type:"relationship",model:"media--image",multiple:!1}},"node--room":{nid:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},title:{type:"string"},created:{type:"number"},changed:{type:"number"},promote:{type:"boolean"},sticky:{type:"boolean"},path:{type:"object"},field_capacity_max:{type:"integer"},field_capacity_min:{type:"integer"},field_reservable_online:{type:"boolean"},field_room_fees:{type:"object"},field_room_standard_equipment:{type:"array"},field_reservation_phone_number:{type:"string"},field_staff_use_only:{type:"boolean"},field_text_content:{type:"object"},field_text_intro:{type:"object"},field_text_teaser:{type:"string"},type:{type:"relationship",model:"node_type--node_type",multiple:!1},uid:{type:"relationship",model:"user--user",multiple:!1},image_primary:{type:"relationship",model:"media--image",multiple:!1},field_location:{type:"relationship",model:"node--location",multiple:!1},field_room_type:{type:"relationship",model:"taxonomy_term--room_type",multiple:!1}},"room_reservation--room_reservation":{title:{type:"string"},id:{type:"integer"},uuid:{type:"string"},status:{type:"boolean"},created:{type:"number"},changed:{type:"number"},location:{type:"string"},field_attendee_count:{type:"integer"},field_dates:{type:"object"},field_group_name:{type:"string"},field_meeting_dates:{type:"object"},field_meeting_purpose_details:{type:"string"},field_refreshments:{type:"boolean"},field_refreshments_description:{type:"object"},field_status:{type:"string"},author:{type:"relationship",model:"user--user",multiple:!1},image:{type:"relationship",model:"media--image",multiple:!1},field_room:{type:"relationship",model:"node--room",multiple:!1},field_meeting_purpose:{type:"relationship",model:"taxonomy_term--meeting_purpose",multiple:!1},field_event:{type:"relationship",model:"node--event",multiple:!1},field_user:{type:"relationship",model:"user--user",multiple:!1}},"taxonomy_term--audience":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--audience",multiple:!0}},"taxonomy_term--equipment_type":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--equipment_type",multiple:!0}},"taxonomy_term--evaluation_criteria":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},field_evaluation:{type:"integer"},parent:{type:"relationship",model:"taxonomy_term--evaluation_criteria",multiple:!0}},"taxonomy_term--event_type":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},field_examples:{type:"string"},parent:{type:"relationship",model:"taxonomy_term--event_type",multiple:!0}},"taxonomy_term--lc_subject":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--lc_subject",multiple:!0}},"taxonomy_term--meeting_purpose":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},field_requires_explanation:{type:"boolean"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--meeting_purpose",multiple:!0}},"taxonomy_term--population_segment":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--population_segment",multiple:!0}},"taxonomy_term--room_type":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--room_type",multiple:!0}},"taxonomy_term--tag":{tid:{type:"integer"},uuid:{type:"string"},name:{type:"string"},description:{type:"object"},weight:{type:"integer"},changed:{type:"number"},path:{type:"object"},parent:{type:"relationship",model:"taxonomy_term--tag",multiple:!0}},"user--user":{uid:{type:"integer"},uuid:{type:"string"},preferred_langcode:{type:"object"},preferred_admin_langcode:{type:"object"},name:{type:"string"},pass:{type:"object"},mail:{type:"string"},timezone:{type:"string"},status:{type:"boolean"},created:{type:"number"},changed:{type:"number"},access:{type:"number"},login:{type:"number"},init:{type:"string"},path:{type:"object"},roles:{type:"relationship",model:"user_role--user_role",multiple:!0}}},la=Object.keys(ca).map(function(e){return{resource:e,strategy:"overrideAll"}}),pa=Nr(Yr(la,function(e){return e.resource}),function(e){return sa(e.resource,e.strategy)}),fa=Nr(ca,function(e,t){return new Lo(t.split("--")[0],t.split("--")[1],e)});return{actions:O,constants:T,reducer:pa,api:Nr(fa,function(e){return new Xo({model:e,priority:2})}),models:fa}});
